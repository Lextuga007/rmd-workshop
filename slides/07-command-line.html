<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Command line</title>
    <meta charset="utf-8" />
    <meta name="author" content="Zo√´ Turner" />
    <meta name="date" content="2022-02-24" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <script src="libs/clipboard/clipboard.min.js"></script>
    <link href="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.js"></script>
    <script>window.xaringanExtraClipboard(null, {"button":"Copy Code","success":"Copied!","error":"Press Ctrl+C to Copy"})</script>
    <link href="libs/shareon/shareon.min.css" rel="stylesheet" />
    <script src="libs/shareon/shareon.min.js"></script>
    <link href="libs/xaringanExtra-shareagain/shareagain.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-shareagain/shareagain.js"></script>
    <link href="libs/countdown/countdown.css" rel="stylesheet" />
    <script src="libs/countdown/countdown.js"></script>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
    <link rel="stylesheet" href="assets/css/my-theme.css" type="text/css" />
    <link rel="stylesheet" href="assets/css/my-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">






class: title-slide, center, middle

&lt;span class="fa-stack fa-4x"&gt;
  &lt;i class="fa fa-circle fa-stack-2x" style="color: #ffffffcc;"&gt;&lt;/i&gt;
  &lt;strong class="fa-stack-1x" style="color:#e7553c;"&gt;07&lt;/strong&gt;
&lt;/span&gt; 

# Command line

---
class: inverse, center, middle

# &lt;center&gt;Command line&lt;/center&gt;

&lt;span class="fa-stack fa-4x"&gt;
  &lt;i class="fa fa-circle fa-stack-2x" style="color: #fff;"&gt;&lt;/i&gt;
  &lt;strong class="fa-stack-1x" style="color:#17a2b8;"&gt;1 &lt;/strong&gt;
&lt;/span&gt; 

---
class: middle, center

# Rendering

.pull-left[

So far: üß∂

]

.pull-right[

```r
render("02-bakeoff-finales.Rmd")
```

]
---
class: your-turn

# Your turn

Instead of using the "Knit" button, try running this code in your R console:


```r
library(rmarkdown) # needs to be loaded first
render("02-bakeoff-finales.Rmd")
```


Now try changing the parameters:


```r
render("02-bakeoff-finales.Rmd",
       params = list(series = "9"))
```

__If this was easy__, play with the other parameters too. Or see if you can change the output format, and add output options.

_psst...answers on the next slide..._


<div class="countdown" id="timer_6217ed9b" style="right:0;bottom:0;" data-warnwhen="0">
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---
class: your-turn

# Answer


```r
render("02-bakeoff-finales.Rmd",
       params = list(series = "9"), 
       output_format = distill::distill_article(toc = TRUE))
```


---
class: middle, center, inverse

&lt;span class="fa-stack fa-4x"&gt;
  &lt;i class="fa fa-circle fa-stack-2x" style="color: #fff;"&gt;&lt;/i&gt;
  &lt;strong class="fa-stack-1x" style="color:#17a2b8;"&gt;2 &lt;/strong&gt;
&lt;/span&gt; 

--

# Render loops


---
class: live-code

# We loop together



```r
# the setup
series &lt;- sort(unique(ratings$series))

# the loop
for (this_series in series) {
  render("02-bakeoff-finales.Rmd",
         params = list(series = this_series))
}
```

_psst...the wrong way_

---

&lt;img src="images/joy-of-fp/forloops.png" width="80%" style="display: block; margin: auto;" /&gt;


---

# We need two things

For the `rmarkdown::render()` function to work they way we want:

1. The list of series -&gt; `params`

1. The name of each report -&gt; `output_file`

We could do this with a loop, but let's start **purrr**ing...

---
class: center, middle, inverse

&gt; "Of course someone has to write **loops**. 

&gt; It doesn't have to be _you_.

&gt; &amp;mdash; Jenny Bryan

---

&lt;img src="images/joy-of-fp/map_frosting.png" width="7825" style="display: block; margin: auto;" /&gt;

---

&lt;img src="images/joy-of-fp/map2_cupcakes.png" width="7825" style="display: block; margin: auto;" /&gt;


---

# Rendering multiple reports


```r
# the setup

paths &lt;- paste0("series-", series)

# series needs to be a list
series &lt;- sort(unique(ratings$series))
params &lt;- map(series, ~ list(series = .x))
str(params)
```


```r
walk2(
  paths, params,
  ~ rmarkdown::render("02-bakeoff-finales.Rmd", output_file = .x, params = .y)
)
```


---
class: your-turn

# Your turn

Try to get this set-up working locally for you.


```r
# the setup

paths &lt;- paste0("series-", series)

# series needs to be a list
series &lt;- sort(unique(ratings$series))
params &lt;- map(series, ~ list(series = .x))
str(params)
```


```r
walk2(
  paths, params,
  ~ rmarkdown::render("02-bakeoff-finales.Rmd", output_file = .x, params = .y)
)
```

<div class="countdown" id="timer_6217ef29" style="right:0;bottom:0;" data-warnwhen="0">
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>


---
class: live-code

# Digging deeper

So now the output file name changed, but we can go deeper.

Let's say we'd also like the change the title in our YAML.

Let's do this together.

(make sure the below is in quotes)

```yaml
---
title: The Great British Bake Off, Series `r params$series`
---
```

---
class: your-turn

# Your turn

Use your render script again and check to make sure that the titles now have the series number in them. 

It is good practice to save your rendering script in the project, call it `_render.R`.

<div class="countdown" id="timer_6217eda1" style="right:0;bottom:0;" data-warnwhen="0">
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>


---
class: middle, center

# üç±

# Time for lunch!

<div class="countdown blink-colon noupdate-15" id="timer_6217efb1" style="right:0;bottom:0;" data-warnwhen="0">
<code class="countdown-time"><span class="countdown-digits minutes">60</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "dracula",
"highlightLanguage": ["r", "yaml", "markdown"],
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
